<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Minecraft Test</title>
    <style>
        body { margin: 0; overflow: hidden; }
        #debugInfo {
            position: fixed;
            top: 10px;
            left: 10px;
            color: white;
            font-family: monospace;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="debugInfo">Caricamento...</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
    class MinecraftTest {
        constructor() {
            this.debugElement = document.getElementById('debugInfo');
            this.debug("Inizializzazione...");

            try {
                // Test Three.js
                if (!THREE) {
                    throw new Error("Three.js non caricato");
                }
                this.debug("Three.js caricato correttamente");

                // Scena base
                this.scene = new THREE.Scene();
                this.debug("Scena creata");

                // Camera
                this.camera = new THREE.PerspectiveCamera(
                    75,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    1000
                );
                this.camera.position.z = 5;
                this.debug("Camera configurata");

                // Renderer
                this.renderer = new THREE.WebGLRenderer();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(this.renderer.domElement);
                this.debug("Renderer creato");

                // Cubo test
                const geometry = new THREE.BoxGeometry();
                const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
                this.cube = new THREE.Mesh(geometry, material);
                this.scene.add(this.cube);
                this.debug("Cubo test aggiunto");

                // Luce ambientale
                const light = new THREE.AmbientLight(0x404040);
                this.scene.add(light);
                this.debug("Luce aggiunta");

                // Eventi resize
                window.addEventListener('resize', () => {
                    this.camera.aspect = window.innerWidth / window.innerHeight;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                });

                this.debug("Inizializzazione completata");
            } catch (error) {
                this.debug("ERRORE: " + error.message);
                console.error(error);
            }
        }

        debug(message) {
            if (this.debugElement) {
                this.debugElement.innerHTML += "<br>" + message;
                console.log(message);
            }
        }

        animate() {
            requestAnimationFrame(() => this.animate());

            try {
                if (this.cube) {
                    this.cube.rotation.x += 0.01;
                    this.cube.rotation.y += 0.01;
                }

                if (this.renderer && this.scene && this.camera) {
                    this.renderer.render(this.scene, this.camera);
                }
            } catch (error) {
                this.debug("ERRORE ANIMAZIONE: " + error.message);
            }
        }

        start() {
            this.debug("Avvio animazione");
            this.animate();
        }
    }

    // Avvio con gestione errori
    window.onload = () => {
        try {
            const game = new MinecraftTest();
            game.start();
        } catch (error) {
            console.error("Errore fatale:", error);
            document.getElementById('debugInfo').innerHTML += "<br>ERRORE FATALE: " + error.message;
        }
    };
    </script>
</body>
</html>
